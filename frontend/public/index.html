<!DOCTYPE html><html lang="en"><head>
<meta charset="UTF-8"><title>AI4Pi Partial Test</title>
<!-- Pi SDK -->
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<style>
body{font-family:sans-serif;text-align:center;margin:2em}button{margin:.5em;padding:.6em 1em;
border:none;border-radius:4px;background:#333;color:#fff;cursor:pointer}button:hover{background:#555}
#status{margin-bottom:.5em}#chatBox{border:1px solid #ccc;height:200px;overflow-y:auto;padding:.5em;
margin:1em auto;max-width:400px;text-align:left}#chatInput{width:70%;padding:.4em}
</style></head><body><h1>AI4Pi Partial Test</h1>
<div id="status">Unregistered User</div>
<button onclick="login()">Login with Pi</button>
<button onclick="pay()">Pay 3.14 Pi</button>
<div id="chatBox"></div>
<input id="chatInput" placeholder="Type message..."><button onclick="send()">Send</button>
<script>
/* 
  If your domain is in Testnet/Development, set SANDBOX = true
  If your domain is in Production, set SANDBOX = false
*/
const SANDBOX = true;
let user = null;

window.onload = () => { 
  // Initialize Pi
  Pi.init({version:"2.0",sandbox:SANDBOX});
};

// Generate a fake "partial test" hash for demonstration
function mockHash(){
  let s="0x";for(let i=0;i<16;i++)s+=(Math.floor(Math.random()*16)).toString(16);
  return s;
}

// Pi login triggers Piâ€™s built-in prompt in the Pi Browser
function login(){
  alert("Initiating Pi login...");
  Pi.authenticate(["username"], auth => {
    if(!auth.user){alert("Login failed."); user=null; setStatus("Unregistered User");}
    else{alert("Welcome, "+auth.user.username); user=auth.user.username; setStatus("Logged in as "+user);}
  }, err => {
    alert("Login error: "+err); user=null; setStatus("Unregistered User");
  });
}

// Pi payment with a mock partial test for transaction hashes
function pay(){
  alert("Initiating Pi payment...");
  // Real Pi payment
  Pi.createPayment({amount:3.14,memo:"AI4Pi Payment",metadata:{test:"data"}},{
    onSuccessfulPayment:(pid,tx)=>{
      alert("Payment success! TxID: "+tx);
    },
    onError:e=>alert("Payment error: "+e),
    onPaymentCancel:pid=>alert("Payment cancelled: "+pid)
  });
  // For partial testing, let's log a fake hash
  console.log("Partial test hash:", mockHash());
}

// Update user status text
function setStatus(txt){document.getElementById("status").innerText=txt;}

// Chat area: user can always chat, whether logged in or not
function addMsg(sender,msg){
  let c=document.getElementById("chatBox"),p=document.createElement("p");
  p.innerHTML="<strong>"+sender+":</strong> "+msg;c.appendChild(p);c.scrollTop=c.scrollHeight;
}
function send(){
  let i=document.getElementById("chatInput"),v=i.value.trim();if(!v)return;
  addMsg("You",v);i.value="";
  setTimeout(()=>addMsg("AI","Echo: "+v),800);
}
</script></body></html>