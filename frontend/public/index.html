<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI4Pi</title>
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:sans-serif; }
  body { display:flex; flex-direction:column; height:100vh; padding:1em; }
  .top-half { display:flex; flex:1; gap:1em; }
  .container { flex:1; display:flex; flex-direction:column; padding:1em; border:1px solid #ccc; background:#f9f9f9; border-radius:8px; }
  h4 { margin-bottom:.5em; text-align:center; }
  button { margin:.3em; padding:.5em .8em; border:none; background:#333; color:#fff; cursor:pointer; border-radius:4px; }
  button:hover { background:#555; }
  #chatBox, #gratitudeBox { flex:1; border:1px solid #ccc; overflow-y:auto; padding:.5em; font-size:small; background:#fff; border-radius:4px; }
  input { width:100%; padding:.3em; margin-top:.5em; }
  .bottom-half { flex:1; border:1px dashed #ccc; text-align:center; display:flex; align-items:center; justify-content:center; font-size:smaller; color:#aaa; }
</style>
</head>
<body>

<div class="top-half">
  <!-- AI Chat Section -->
  <div class="container">
    <h4>AI4Pi Chat</h4>
    <div id="status">Unregistered User</div>
    <button onclick="login()">Login with Pi</button>
    <button onclick="pay()">Pay 3.14 Pi</button>
    <div id="chatBox"></div>
    <input id="chatInput" placeholder="Type message...">
    <button onclick="send()">Send</button>
  </div>

  <!-- Gratitude Stream Section -->
  <div class="container">
    <h4>Gratitude Stream</h4>
    <div id="gratitudeBox"></div>
    <input id="gratitudeInput" placeholder="What are you thankful for?">
    <button onclick="submitGratitude()">Submit</button>
  </div>
</div>

<!-- Future Expansion Area -->
<div class="bottom-half">Reserved for future features</div>

<script>
const SANDBOX=true; let user=null;
onload=()=>Pi.init({version:"2.0",sandbox:SANDBOX});

function login(){
  alert("Initiating Pi login...");
  Pi.authenticate(["username"],a=>{
    user=a.user?a.user.username:null; alert(user?"Welcome, "+user:"Login failed.");
    status.innerText=user?"Logged in as "+user:"Unregistered User";
  },e=>{alert("Login error: "+e); status.innerText="Unregistered User";});
}

function pay(){
  alert("Initiating Pi payment...");
  Pi.createPayment({amount:3.14,memo:"AI4Pi Payment",metadata:{test:"data"}},
  {onSuccessfulPayment:(p,t)=>alert("Payment success! TxID: "+t),
  onError:e=>alert("Payment error: "+e),
  onPaymentCancel:p=>alert("Payment cancelled: "+p)});
}

function send(){
  let v=chatInput.value.trim(); if(!v)return; chatInput.value="";
  chatBox.innerHTML+=`<p><strong>You:</strong> ${v}</p>`;
  setTimeout(()=>chatBox.innerHTML+=`<p><strong>AI:</strong> Echo: ${v}</p>`,800);
}

function submitGratitude(){
  let v=gratitudeInput.value.trim(); if(!v)return; gratitudeInput.value="";
  gratitudeBox.innerHTML+=`<p>${v}</p>`;
}
</script>

</body>
</html>