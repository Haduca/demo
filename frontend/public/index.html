<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI4Pi Test</title>
  <!-- Load the Pi SDK -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 3em; }
    button { margin: 1em; padding: 0.6em 1em; font-size: 1em; }
  </style>
</head>
<body>
  <h1>AI4Pi Test</h1>
  <button onclick="loginWithPi()">Login with Pi</button>
  <button onclick="payWithPi()">Pay 3.14 Pi</button>
  <script>
    // Set sandbox mode: true for Testnet/Development; false for Production.
    const SANDBOX_MODE = true;
    // Initialize Pi SDK on page load.
    window.onload = () => { 
      Pi.init({ version: "2.0", sandbox: SANDBOX_MODE }); 
      // Optional: Confirm the SDK loaded.
      alert("Pi SDK loaded: " + (typeof window.Pi !== "undefined"));
    };

    // Function to trigger Pi login.
    function loginWithPi() {
      alert("Initiating Pi login...");
      Pi.authenticate(["username"], (auth) => {
        if(auth.user) {
          alert("Login successful: " + auth.user.username);
        } else {
          alert("Login failed: No user data returned.");
        }
      }, (err) => { 
        alert("Login error: " + err);
      });
    }

    // Function to trigger Pi payment.
    function payWithPi() {
      alert("Initiating Pi payment...");
      const payment = {
        amount: 3.14,
        memo: "AI4Pi Payment",
        metadata: { test: "debug" }
      };
      Pi.createPayment(payment, {
        onReadyForServerApproval: (paymentId) => { console.log("Payment ID:", paymentId); },
        onReadyForServerCompletion: (paymentId, txid) => { console.log("Ready for completion:", paymentId, txid); },
        onSuccessfulPayment: (paymentId, txid) => { alert("Payment successful! TxID: " + txid); },
        onError: (err) => { alert("Payment error: " + err); },
        onPaymentCancel: (paymentId) => { alert("Payment cancelled: " + paymentId); }
      });
    }
  </script>
</body>
</html>