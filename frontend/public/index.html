<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI4Pi Minimal</title>
  <!-- Pi Network SDK -->
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</head>
<body>
  <h1>Welcome to AI4Pi</h1>
  <button onclick="loginWithPi()">Login with Pi</button>
  <button onclick="payWithPi()">Pay 3.14 Pi</button>

  <script>
    // Change sandbox to 'true' if you're testing in the Pi Browser on Testnet.
    // Change sandbox to 'false' if you're ready for Production/Mainnet.
    window.onload = function() {
      Pi.init({ version: "2.0", sandbox: true });
    };

    // Pi Login
    function loginWithPi() {
      Pi.authenticate(["username"], function(authData) {
        if (!authData.user) {
          alert("Login failed. No user data returned.");
          return;
        }
        alert("Welcome, " + authData.user.username);
      }, function(error) {
        console.error("Authentication error:", error);
        alert("Login failed. Please try again.");
      });
    }

    // Pi Payment
    function payWithPi() {
      const payment = {
        amount: 3.14,
        memo: "AI4Pi Test Payment",
        metadata: { testKey: "testValue" }
      };

      Pi.createPayment(payment, {
        onReadyForServerApproval: function(paymentId) {
          console.log("Payment ID for server approval:", paymentId);
        },
        onReadyForServerCompletion: function(paymentId, txid) {
          console.log("Payment ready for completion:", paymentId, txid);
        },
        onSuccessfulPayment: function(paymentId, txid) {
          console.log("Payment successful:", paymentId, txid);
          alert("Payment successful! TxID: " + txid);
        },
        onError: function(error, payment) {
          console.error("Payment error:", error);
          alert("Payment error: " + error);
        },
        onPaymentCancel: function(paymentId) {
          console.log("Payment cancelled:", paymentId);
        }
      });
    }
  </script>
</body>
</html>