<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AI4Pi</title>
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<style>
  body { font-family:sans-serif; margin:0; padding:0; display:flex; justify-content:flex-start; align-items:flex-start; height:100vh; }
  .container { width:25vw; height:25vh; padding:1em; border:1px solid #ccc; }
  button { margin:.2em; padding:.3em .6em; border:none; background:#333; color:#fff; cursor:pointer; }
  button:hover { background:#555; }
  #chatBox { border:1px solid #ccc; height:8em; overflow-y:auto; padding:.3em; font-size:small; }
  #chatInput { width:60%; padding:.2em; }
</style>
</head>
<body>
<div class="container">
  <h4>AI4Pi Test</h4>
  <div id="status">Unregistered User</div>
  <button onclick="login()">Login</button>
  <button onclick="pay()">Pay 3.14 Pi</button>
  <div id="chatBox"></div>
  <input id="chatInput" placeholder="Type...">
  <button onclick="send()">Send</button>
</div>
<script>
const SANDBOX=true;let user=null;
onload=()=>Pi.init({version:"2.0",sandbox:SANDBOX});
function login(){Pi.authenticate(["username"],a=>{
  user=a.user?a.user.username:null;alert(user?"Welcome, "+user:"Login failed.");
  status.innerText=user?"Logged in as "+user:"Unregistered User";
},e=>{alert("Login error: "+e);status.innerText="Unregistered User";});}
function pay(){Pi.createPayment({amount:3.14,memo:"AI4Pi Payment",metadata:{test:"data"}},
  {onSuccessfulPayment:(p,t)=>alert("Payment success! TxID: "+t),
  onError:e=>alert("Payment error: "+e),
  onPaymentCancel:p=>alert("Payment cancelled: "+p)});}
function send(){let v=chatInput.value.trim();if(!v)return;chatInput.value="";
  chatBox.innerHTML+=`<p><strong>You:</strong> ${v}</p>`;setTimeout(()=>chatBox.innerHTML+=`<p><strong>AI:</strong> Echo: ${v}</p>`,800);}
</script>
</body>
</html>